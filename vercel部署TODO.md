# Vercel éƒ¨ç½² TODOï¼ˆSonoScope Standalone Clientï¼‰

æœ¬æ¸…å•æ±‡æ€»æœ€è¿‘ä¸¤è½®è®¨è®ºä¸ä»£ç å®¡æŸ¥ç»“è®ºï¼Œé¢å‘"æœ€å°å¯ç”¨ + æ¸è¿›å¢å¼º"çš„ç”Ÿäº§éƒ¨ç½²æ–¹æ¡ˆã€‚åŸºäºsubagentåˆ†æå»ºè®®ä¼˜åŒ–ï¼Œé‡ç‚¹è§£å†³ç¯å¢ƒé…ç½®ã€æ¨¡å‹ç®¡ç†ã€æ€§èƒ½ç›‘æ§ç­‰å…³é”®é—®é¢˜ã€‚

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦

**éƒ¨ç½²ç­–ç•¥**ï¼šé‡‡ç”¨"æ ¸å¿ƒåŠŸèƒ½ä¼˜å…ˆ + æ¸è¿›å¢å¼º"çš„ç­–ç•¥ï¼Œç¡®ä¿åŸºç¡€åŠŸèƒ½ç¨³å®šè¿è¡Œï¼Œé«˜çº§ç‰¹æ€§å¯é€‰åŠ è½½

**å…³é”®ä¼˜åŒ–ç‚¹ï¼ˆå·²èšç„¦ä¸ºå¯ç«‹å³ä¸Šçº¿çš„æœ€å°é›†ï¼‰**ï¼š
- ç¯å¢ƒé…ç½®ï¼šä»æ–‡ä»¶ç³»ç»Ÿè¿ç§»åˆ°Vercelç¯å¢ƒå˜é‡
- æ¨¡å‹ç®¡ç†ï¼šç»Ÿä¸€æ¨¡å‹åŠ è½½è·¯å¾„ï¼Œä¼˜åŒ–TFJSåŠ¨æ€åŠ è½½
- æ€§èƒ½ç›‘æ§ï¼šé›†æˆå®Œæ•´çš„å‰ç«¯ç›‘æ§ä½“ç³»
- ç¼“å­˜ç­–ç•¥ï¼šå®Œå–„é™æ€èµ„æºç¼“å­˜é…ç½®

**é¢„æœŸæˆæœ**ï¼šé¦–åŒ…ä½“ç§¯å‡å°‘60%ï¼ŒåŠ è½½é€Ÿåº¦æå‡40%ï¼Œç§»åŠ¨ç«¯å…¼å®¹æ€§æ˜¾è‘—æ”¹å–„

---

## 0. å½“å‰çŠ¶æ€ï¼ˆå·²å®Œæˆï¼‰
- æ ¹è·¯ç”±é‡å®šå‘åˆ° `/standalone-client`ï¼Œé¦–é¡µå³ç‹¬ç«‹å®¢æˆ·ç«¯
- è°ƒè¯•/æµ‹è¯•é¡µä¿ç•™ï¼š`/test`
- æ¸…ç†æœªç”¨é¡µé¢ï¼š`client-shell/`ã€`danmu-demo/`ã€`danmu-test/`ã€`real-danmu/`
- æœ¬åœ°æ„å»ºé€šè¿‡ï¼ˆNext 14ï¼‰ï¼š`pnpm --filter app build`

---

## 1. ç¯å¢ƒé…ç½®é‡æ„ï¼ˆæŒ‰éœ€ï¼‰

### 1.1 ç¯å¢ƒå˜é‡è¿ç§»
- [ ] è‹¥ä¸Šçº¿ç‰ˆæœ¬éœ€è¦äº‘ç«¯ APIï¼ˆå¦‚ GLMï¼‰ï¼Œå°† `env.local.json` é…ç½®è¿ç§»åˆ° Vercel ç¯å¢ƒå˜é‡ï¼›å¦åˆ™æœ¬é¡¹å¯å»¶åè‡³ P1
- [ ] åœ¨ `app/app/standalone-client/page.tsx` ä¸­æ·»åŠ ç¯å¢ƒå˜é‡éªŒè¯é€»è¾‘ï¼ˆå­˜åœ¨äº‘ç«¯ä¾èµ–æ—¶ï¼‰
- [ ] å®ç°é…ç½®å›é€€æœºåˆ¶ï¼Œç¡®ä¿ç¯å¢ƒå˜é‡ç¼ºå¤±æ—¶çš„ä¼˜é›…é™çº§

```typescript
// ç¯å¢ƒé…ç½®ç¤ºä¾‹
const GLM_CONFIG = {
  apiKey: process.env.NEXT_PUBLIC_GLM_API_KEY || '',
  apiUrl: process.env.NEXT_PUBLIC_GLM_URL || 'https://open.bigmodel.cn/api/paas/v4/chat/completions',
  // æ·»åŠ éªŒè¯é€»è¾‘
  isValid: () => {
    return !!process.env.NEXT_PUBLIC_GLM_API_KEY;
  }
};
```

### 1.2 æ¨¡å‹è·¯å¾„ç»Ÿä¸€ï¼ˆTFLite ä¸ºä¸»ï¼ŒTFJS ä½œä¸ºå›é€€ï¼‰
- [ ] ç¡®è®¤å¹¶ç»Ÿä¸€æ¨¡å‹æ–‡ä»¶éƒ¨ç½²è·¯å¾„ï¼Œç”Ÿäº§ä¼˜å…ˆä½¿ç”¨ TFLiteï¼š`/model/yamnet_tflite/yamnet.tflite`
- [ ] ä¿ç•™ TFJS GraphModel ä½œä¸ºå›é€€è·¯å¾„ï¼ˆå¯é€‰ï¼‰ï¼š`/model/yamnet/model.json`
- [ ] ä¿®æ”¹åŠ è½½é€»è¾‘æè¿°ä¸ç¤ºä¾‹ï¼Œé¿å…å¤šè·¯å¾„åŒæ—¶ä¸»ç”¨ï¼Œå‡å°‘ç»´æŠ¤æˆæœ¬
- [ ] éªŒè¯æ¨¡å‹æ–‡ä»¶åœ¨ Vercel ç¯å¢ƒä¸­çš„å¯è®¿é—®æ€§ï¼ˆ200/ç¼“å­˜å¤´ï¼‰

```typescript
// ç»Ÿä¸€æ¨¡å‹åŠ è½½è·¯å¾„ï¼ˆç”Ÿäº§ä¸»ç”¨ TFLiteï¼ŒGraphModel ä»…ä½œä¸ºå›é€€ï¼‰
const MODEL_PATHS = {
  yamnetTFLite: '/model/yamnet_tflite/yamnet.tflite',
  // ä»…å½“åç»­æä¾›äº† TFJS GraphModel æ—¶å¯ç”¨å›é€€
  yamnetGraphModel: '/model/yamnet/model.json'
};
```

---

## 2. é¦–åŒ…ä¸æ¨¡å‹ç­–ç•¥ï¼ˆå¿…é¡»ï¼‰

### 2.1 TFJS/TFLite åŠ¨æ€åŠ è½½ä¼˜åŒ–
- [ ] å®Œå…¨ç§»é™¤ `page.tsx` é¡¶å±‚ `import '@tensorflow/tfjs'`
- [ ] å®ç°æ¡ä»¶åŠ¨æ€åŠ è½½ï¼Œä»…åœ¨éœ€è¦æ—¶æŒ‰éœ€åŠ è½½ `@tensorflow/tfjs` ä¸ `@tensorflow/tfjs-tflite`
- [ ] æ·»åŠ åŠ è½½çŠ¶æ€æŒ‡ç¤ºå™¨å’Œè¿›åº¦æ˜¾ç¤º
- [ ] å®ç°è¶…æ—¶é‡è¯•æœºåˆ¶ï¼ˆ2â€“3 ç§’è¶…æ—¶ï¼‰

```typescript
// æŒ‰éœ€åŠ è½½ TFJSï¼ˆé¦–åŒ…ä¸å¼•å…¥ï¼‰
const loadTFJS = async (): Promise<any> => {
  if (typeof window === 'undefined') return null;
  try {
    const tf = await import('@tensorflow/tfjs');
    await tf.ready();
    return tf;
  } catch (error) {
    console.error('TFJSåŠ è½½å¤±è´¥:', error);
    return null;
  }
};

// æŒ‰éœ€åŠ è½½ TFLite è¿è¡Œæ—¶ï¼ˆä¼˜å…ˆç”¨äºç§»åŠ¨ç«¯ï¼‰
const loadTFLite = async (): Promise<any> => {
  if (typeof window === 'undefined') return null;
  try {
    return await import('@tensorflow/tfjs-tflite');
  } catch (error) {
    console.error('TFLiteè¿è¡Œæ—¶åŠ è½½å¤±è´¥:', error);
    return null;
  }
};
```

### 2.2 æ¨¡å‹æ–‡ä»¶ç®¡ç†
- [ ] ç¡®è®¤YAMNetæ¨¡å‹æ–‡ä»¶å®é™…å­˜åœ¨å¹¶å¯è®¿é—®
- [ ] å®ç°æ¨¡å‹æ–‡ä»¶çš„CDNåŠ é€Ÿï¼ˆå¯é€‰ï¼‰
- [ ] æ·»åŠ æ¨¡å‹æ–‡ä»¶å®Œæ•´æ€§æ ¡éªŒ
- [ ] å…¶ä½™æ¨¡å‹ï¼ˆCREPE/OpenL3/Musicnnï¼‰é™çº§ä¸ºå¯å‘å¼

### 2.3 æ•°æ®å¤–ç½®ä¼˜åŒ–
- [ ] å°†YAMNetæ ‡ç­¾æ˜ å°„ï¼ˆ521è¡Œï¼‰æ‹†åˆ†ä¸ºç‹¬ç«‹JSONæ–‡ä»¶
- [ ] å®ç°æ ‡ç­¾æ–‡ä»¶çš„æ‡’åŠ è½½å’Œç¼“å­˜
- [ ] å°†å…¶ä»–å¤§å¸¸é‡æ•°æ®å¤–ç½®

---

## 3. æ€§èƒ½ä¸ç¼“å­˜ä¼˜åŒ–ï¼ˆå¿…é¡»ï¼‰

### 3.1 ä»£ç åˆ†å‰²ä¼˜åŒ–
- [ ] Meydaå›è°ƒçŠ¶æ€æ›´æ–°èŠ‚æµï¼ˆæ¯60-120msæ›´æ–°UIï¼‰
- [ ] å¯è§†åŒ–é¢„è®¾åŠ¨æ€åˆ†åŒ…ï¼š`dynamic(() => import(...), { ssr: false })`
- [ ] ä½¿ç”¨`requestIdleCallback`é¢„å–éå…³é”®èµ„æº

### 3.2 ç¼“å­˜ä¸æƒé™ç­–ç•¥é…ç½®
- [ ] åœ¨ `next.config.js` ä¸­é…ç½®é™æ€èµ„æºç¼“å­˜ç­–ç•¥
- [ ] æ¨¡å‹æ–‡ä»¶è®¾ç½®é•¿æœŸç¼“å­˜ï¼ˆ1 å¹´ï¼‰
- [ ] Shader/çº¹ç†/å­—ä½“èµ„æºé…ç½®é€‚å½“ç¼“å­˜
- [ ] æ·»åŠ  `Permissions-Policy: microphone=(self)` ä»¥æå‡æƒé™æ˜ç¡®æ€§

```javascript
// next.config.js ç¼“å­˜ä¸æƒé™ç­–ç•¥é…ç½®ï¼ˆåœ¨ç°æœ‰ COOP/COEP åŸºç¡€ä¸Šè¿½åŠ ï¼‰
module.exports = {
  async headers() {
    return [
      {
        source: '/model/:path*',
        headers: [
          { key: 'Cache-Control', value: 'public, max-age=31536000, immutable' }
        ],
      },
      {
        source: '/static/:path*',
        headers: [
          { key: 'Cache-Control', value: 'public, max-age=86400' }
        ],
      },
      {
        source: '/:path*',
        headers: [
          { key: 'Permissions-Policy', value: 'microphone=(self)' }
        ]
      }
    ];
  }
};
```

### 3.3 ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–
- [ ] ç”Ÿäº§æ—¥å¿—æœ€å°åŒ–ï¼šä»…è¾“å‡ºerror/warn
- [ ] ç§»é™¤å¼€å‘ç¯å¢ƒç‰¹æœ‰çš„è°ƒè¯•ä»£ç 
- [ ] ä¼˜åŒ–Reactç»„ä»¶æ¸²æŸ“æ€§èƒ½

---

## 4. å®‰å…¨é…ç½®ï¼ˆå¿…é¡»ï¼‰

### 4.1 CSP é…ç½®ï¼ˆå»ºè®®åˆ†é˜¶æ®µé€æ­¥æ”¶ç´§ï¼‰
- [ ] é…ç½®é€‚åˆ TFJS/WebGL çš„ CSP ç­–ç•¥ï¼›é¦–å‘å¯å…ˆä¸å¯ç”¨æˆ–é‡‡ç”¨è¾ƒå®½æ¾ç­–ç•¥ï¼ŒéªŒè¯è¿è¡Œè·¯å¾„åå†æ”¶ç´§
- [ ] å®ç°æ¸è¿›å¼ CSP æ”¶ç´§ç­–ç•¥
- [ ] æ·»åŠ å…¶ä»–å¿…è¦çš„å®‰å…¨å¤´éƒ¨

```typescript
// next.config.js å®‰å…¨å¤´éƒ¨é…ç½®
module.exports = {
  async headers() {
    return [
      {
        source: '/:path*',
        headers: [
          {
            key: 'Content-Security-Policy',
            value: [
              "default-src 'self'",
              // åˆæœŸä¸ºä¿éšœè¿è¡Œå¯ç”¨ï¼Œé€‚åº¦æ”¾å®½ï¼›éªŒè¯é€šè¿‡åæŒ‰éœ€æ”¶ç´§
              "script-src 'self' 'unsafe-eval' 'unsafe-inline' blob:",
              "style-src 'self' 'unsafe-inline'",
              "img-src 'self' data: blob:",
              "connect-src 'self' https://open.bigmodel.cn",
              "media-src 'self' blob:",
              "worker-src 'self' blob:",
            ].join('; ')
          },
          {
            key: 'Permissions-Policy',
            value: 'microphone=(self), camera=()'
          },
          {
            key: 'X-Content-Type-Options',
            value: 'nosniff'
          },
          {
            key: 'X-Frame-Options',
            value: 'DENY'
          }
        ],
      }
    ];
  }
};
```

### 4.2 å†…å®¹å®‰å…¨
- [ ] Danmuæ–‡æœ¬å‡€åŒ–ï¼šåœ¨`DanmuEngine.ingestText`å…¥å£è¿›è¡Œsanitize
- [ ] æ·»åŠ è¾“å…¥é•¿åº¦é™åˆ¶å’Œå†…å®¹è¿‡æ»¤
- [ ] å®ç°XSSé˜²æŠ¤æœºåˆ¶

---

## 5. ç›‘æ§ä¸é”™è¯¯å¤„ç†ï¼ˆå¿…é¡»ï¼‰

### 5.1 é”™è¯¯ç›‘æ§é›†æˆ
- [ ] é›†æˆSentryé”™è¯¯ç›‘æ§ï¼ˆä»…ç”Ÿäº§ç¯å¢ƒå¯ç”¨ï¼‰
- [ ] æ·»åŠ å…³é”®è·¯å¾„çš„try-catchåŒ…è£…
- [ ] å®ç°é”™è¯¯è¾¹ç•Œç»„ä»¶

```typescript
// Sentryé›†æˆç¤ºä¾‹
import * as Sentry from '@sentry/nextjs';

if (process.env.NODE_ENV === 'production') {
  Sentry.init({
    dsn: process.env.NEXT_PUBLIC_SENTRY_DSN,
    environment: process.env.NODE_ENV,
  });
}
```

### 5.2 æ€§èƒ½ç›‘æ§
- [ ] é›†æˆWeb Vitalsç›‘æ§
- [ ] æ·»åŠ è‡ªå®šä¹‰æ€§èƒ½æŒ‡æ ‡æ”¶é›†
- [ ] å®ç°ç”¨æˆ·è¡Œä¸ºåˆ†æ

```typescript
// Web Vitalsç›‘æ§
import { getCLS, getFID, getFCP, getLCP, getTTFB } from 'web-vitals';

if (typeof window !== 'undefined') {
  getCLS(console.log);
  getFID(console.log);
  getFCP(console.log);
  getLCP(console.log);
  getTTFB(console.log);
}
```

### 5.3 ç”¨æˆ·åˆ†æ
- [ ] é›†æˆGoogle Analyticsæˆ–Plausible
- [ ] æ·»åŠ ç”¨æˆ·è¡Œä¸ºè¿½è¸ª
- [ ] å®ç°A/Bæµ‹è¯•æ¡†æ¶

---

## 6. ç”¨æˆ·ä½“éªŒä¼˜åŒ–ï¼ˆæ¨èï¼‰

### 6.1 åŠ è½½ä½“éªŒ
- [ ] å®ç°TFJSæ¨¡å‹åŠ è½½çš„è¿›åº¦æ¡
- [ ] æ·»åŠ éª¨æ¶å±å’ŒåŠ è½½çŠ¶æ€æŒ‡ç¤ºå™¨
- [ ] å®ç°ä¼˜é›…çš„é™çº§æç¤º

### 6.2 è®¾å¤‡è‡ªé€‚åº”
- [ ] è®¾å¤‡èƒ½åŠ›æ£€æµ‹ï¼ˆ`hardwareConcurrency`ã€`navigator.deviceMemory`ï¼‰
- [ ] è‡ªåŠ¨è°ƒæ•´ç²’å­æ•°é‡å’Œæ¸²æŸ“è´¨é‡
- [ ] å®ç°ç½‘ç»œæ¡ä»¶è‡ªé€‚åº”

```typescript
// è®¾å¤‡è‡ªé€‚åº”ç¤ºä¾‹
const getDeviceCapabilities = () => {
  return {
    isMobile: /Mobile|Android|iOS/.test(navigator.userAgent),
    memory: navigator.deviceMemory || 4,
    cores: navigator.hardwareConcurrency || 4,
    isSlowConnection: navigator.connection?.effectiveType.includes('2g')
  };
};
```

### 6.3 æ€§èƒ½ä¼˜åŒ–
- [ ] YAMNetæ¨ç†å¸§ç‡é™åˆ¶ä¸º2-4fps
- [ ] å®ç°ç¯å½¢ç¼“å†²æ›¿ä»£åˆ‡ç‰‡æ‹·è´
- [ ] æ·»åŠ é˜²æŠ–å’ŒèŠ‚æµæœºåˆ¶

---

## 7. Vercelé…ç½®ä¼˜åŒ–ï¼ˆå¿…é¡»ï¼‰

### 7.1 æ„å»ºé…ç½®
- [ ] åˆ›å»º `vercel.json` é…ç½®æ–‡ä»¶ï¼ˆä»…å½“éœ€è¦è‡ªå®šä¹‰æ—¶ï¼‰
- [ ] ä¼˜åŒ–æ„å»ºå‘½ä»¤å’Œè¾“å‡ºè®¾ç½®
- [ ] é…ç½®å‡½æ•°è¶…æ—¶å’Œå†…å­˜é™åˆ¶ï¼ˆä»…å½“å¯¹åº” API Route å­˜åœ¨æ—¶æ·»åŠ ï¼‰

```json
{
  "framework": "nextjs",
  "buildCommand": "pnpm --filter app build",
  "installCommand": "pnpm install --frozen-lockfile",
  // ä»…å½“å­˜åœ¨è¯¥ API Route æ—¶å†æ·»åŠ  functions é…ç½®ï¼Œé¿å… Vercel æ ¡éªŒå¤±è´¥
  "functions": {
    "app/app/api/llm-danmu/route.ts": {
      "maxDuration": 10
    }
  }
}
```

### 7.2 ç¯å¢ƒå˜é‡é…ç½®
- [ ] åœ¨Vercelæ§åˆ¶å°é…ç½®å¿…è¦çš„ç¯å¢ƒå˜é‡
- [ ] æ·»åŠ ç¯å¢ƒå˜é‡éªŒè¯å’Œé»˜è®¤å€¼
- [ ] å®ç°é…ç½®æ–‡ä»¶çš„ç‰ˆæœ¬æ§åˆ¶

```bash
# å¿…éœ€çš„ç¯å¢ƒå˜é‡
NEXT_PUBLIC_GLM_API_KEY=your_api_key_here
NEXT_PUBLIC_GLM_URL=https://open.bigmodel.cn/api/paas/v4/chat/completions
NEXT_PUBLIC_SENTRY_DSN=your_sentry_dsn
NEXT_PUBLIC_GA_ID=your_google_analytics_id
```

---

## 8. æ‰“åŒ…åˆ†æä¸ä¼˜åŒ–ï¼ˆæ¨èï¼‰

### 8.1 åŒ…ä½“åˆ†æ
- [ ] é›†æˆ`@next/bundle-analyzer`
- [ ] åˆ†æé¦–åŒ…ä½“ç§¯å’Œå¢é‡åŠ è½½
- [ ] è¯†åˆ«å¹¶ä¼˜åŒ–å¤§ä¾èµ–é¡¹

```bash
# åŒ…ä½“åˆ†æå‘½ä»¤
ANALYZE=true pnpm --filter app build
```

### 8.2 ä¾èµ–ä¼˜åŒ–
- [ ] è¯„ä¼°å¹¶æ›¿æ¢é‡å‹ä¾èµ–
- [ ] å®ç°Tree Shakingä¼˜åŒ–
- [ ] ä¼˜åŒ–CSSå’Œé™æ€èµ„æº

---

## 9. éƒ¨ç½²éªŒè¯Checklistï¼ˆå¿…é¡»ï¼‰

### 9.1 åŠŸèƒ½éªŒè¯
- [ ] ä¸åŒç½‘ç»œç¯å¢ƒä¸‹çš„åŠ è½½æµ‹è¯•ï¼ˆ3G/4G/WiFiï¼‰
- [ ] ç§»åŠ¨è®¾å¤‡å…¼å®¹æ€§æµ‹è¯•ï¼ˆiOS/Androidï¼‰
- [ ] å¤šæµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•ï¼ˆChromeã€Safariã€Firefoxï¼‰
- [ ] é•¿æ—¶é—´è¿è¡Œç¨³å®šæ€§æµ‹è¯•ï¼ˆ1å°æ—¶+ï¼‰

### 9.2 æ€§èƒ½éªŒè¯
- [ ] Lighthouseæ€§èƒ½å®¡è®¡ï¼ˆå¾—åˆ† > 90ï¼‰
- [ ] å†…å­˜æ³„æ¼éªŒè¯ï¼ˆChrome DevToolsï¼‰
- [ ] é¦–åŒ…ä½“ç§¯æ£€æŸ¥ï¼ˆ< 1MBï¼‰
- [ ] åŠ è½½æ—¶é—´æµ‹è¯•ï¼ˆ< 3ç§’ï¼‰

### 9.3 é”™è¯¯æ¢å¤æµ‹è¯•
- [ ] æ–­ç½‘é‡è¿æµ‹è¯•
- [ ] æƒé™æ‹’ç»å¤„ç†
- [ ] æ¨¡å‹åŠ è½½å¤±è´¥é™çº§
- [ ] APIè°ƒç”¨é”™è¯¯å¤„ç†

---

## 10. ä»»åŠ¡ä¼˜å…ˆçº§æ¸…å•

### ğŸš¨ P0 - é˜»å¡é¡¹ï¼ˆç«‹å³å¤„ç†ï¼Œä¿è¯å¯ä¸Šçº¿ï¼‰
- [ ] ç»Ÿä¸€ YAMNet æ¨¡å‹è·¯å¾„ï¼ˆç”Ÿäº§ä¸»ç”¨ TFLiteï¼š`/model/yamnet_tflite/yamnet.tflite`ï¼‰ï¼Œå¹¶éªŒè¯ 200/ç¼“å­˜
- [ ] å°† TFJS ä¸ `@tensorflow/tfjs-tflite` æ”¹ä¸ºæŒ‰éœ€åŠ¨æ€å¯¼å…¥ï¼ˆç§»é™¤é¡¶å±‚é™æ€ importï¼‰
- [ ] åœ¨ `next.config.js` æ·»åŠ ï¼š
  - [ ] `/model/:path*` é•¿ç¼“å­˜ `Cache-Control: public, max-age=31536000, immutable`
  - [ ] `Permissions-Policy: microphone=(self)`
- [ ]ï¼ˆå¯é€‰ï¼‰CSP ä»¥å®½æ¾ç­–ç•¥æˆ–æš‚ä¸å¯ç”¨ï¼Œå¾…éªŒè¯è·¯å¾„åå†æ”¶ç´§

### â­ P1 - é‡è¦é¡¹ï¼ˆæœ¬å‘¨å®Œæˆï¼‰
- [ ] è‹¥ä½¿ç”¨äº‘ç«¯ APIï¼šç¯å¢ƒå˜é‡è¿ç§»ä¸éªŒè¯ï¼ˆå«ç¼ºçœå€¼ä¸æ ¡éªŒï¼‰
- [ ] YAMNet æ ‡ç­¾æ˜ å°„å¤–ç½®ä¸º JSON å¹¶æ‡’åŠ è½½
- [ ] Meyda çŠ¶æ€æ›´æ–°èŠ‚æµï¼ˆ60â€“120msï¼‰
- [ ] é¢„è®¾åŠ¨æ€åˆ†åŒ…ã€ç”Ÿäº§æ—¥å¿—æœ€å°åŒ–
- [ ] å®Œå–„é”™è¯¯å¤„ç†ä¸ä¼˜é›…é™çº§æç¤º

### ğŸ“Š P2 - ä¼˜åŒ–é¡¹ï¼ˆä¸‹å‘¨å®Œæˆï¼‰
- [ ] è®¾å¤‡è‡ªé€‚åº”
- [ ] ç”¨æˆ·ä½“éªŒä¼˜åŒ–
- [ ] åŒ…ä½“åˆ†æå’Œä¼˜åŒ–
- [ ] A/Bæµ‹è¯•æ¡†æ¶

### ğŸ”§ P3 - é•¿æœŸé¡¹ï¼ˆæŒç»­ä¼˜åŒ–ï¼‰
- [ ] PWAæ”¯æŒ
- [ ] é«˜çº§ç›‘æ§
- [ ] æ€§èƒ½è°ƒä¼˜
- [ ] ç”¨æˆ·åé¦ˆæ”¶é›†

---

## 11. é£é™©ç®¡ç†ä¸åº”å¯¹

### âš ï¸ é«˜é£é™©é¡¹
1. **æ¨¡å‹åŠ è½½æ€§èƒ½**ï¼š4MB+ TFJSå¯èƒ½å½±å“ç”¨æˆ·ä½“éªŒ
   - ç¼“è§£ï¼šè¿›åº¦æ¡ã€é¢„åŠ è½½ã€CDNåŠ é€Ÿ

2. **ç¯å¢ƒé…ç½®è¿ç§»**ï¼šå¯èƒ½å½±å“ç°æœ‰åŠŸèƒ½
   - ç¼“è§£ï¼šæ¸è¿›å¼è¿ç§»ã€ä¿ç•™å›é€€æœºåˆ¶

3. **ç§»åŠ¨ç«¯å…¼å®¹æ€§**ï¼šWebGL/Web Audio APIæ”¯æŒå·®å¼‚
   - ç¼“è§£ï¼šç‰¹æ€§æ£€æµ‹ã€ä¼˜é›…é™çº§

### ğŸ›¡ï¸ ä¸­é£é™©é¡¹
1. **åŒ…ä½“ç§¯æ§åˆ¶**ï¼šéœ€è¦æŒç»­ç›‘æ§
   - ç¼“è§£ï¼šå®šæœŸåˆ†æã€ä¾èµ–ä¼˜åŒ–

2. **æµè§ˆå™¨å…¼å®¹æ€§**ï¼šç‰¹åˆ«æ˜¯Safarié™åˆ¶
   - ç¼“è§£ï¼šå…¼å®¹æ€§æµ‹è¯•ã€polyfill

3. **ç½‘ç»œæ¡ä»¶**ï¼šä¸åŒç¯å¢ƒä¸‹çš„åŠ è½½ä½“éªŒ
   - ç¼“è§£ï¼šè‡ªé€‚åº”åŠ è½½ã€ç¦»çº¿ç¼“å­˜

---

## 12. éƒ¨ç½²æ­¥éª¤æŒ‡å—

### é˜¶æ®µ1ï¼šåŸºç¡€é…ç½®ï¼ˆ1å¤©ï¼‰
1. ä»£ç å‡†å¤‡
   - ç¡®è®¤æ ¹ç›®å½• `package.json` / `pnpm-workspace.yaml` æ­£å¸¸
   - é…ç½® `app/next.config.js` å¤´éƒ¨å’Œç¼“å­˜ç­–ç•¥
   - åˆ›å»º `vercel.json` é…ç½®æ–‡ä»¶

2. ç¯å¢ƒé…ç½®
   - åœ¨Vercelæ§åˆ¶å°é…ç½®ç¯å¢ƒå˜é‡
   - å®ç°ç¯å¢ƒå˜é‡éªŒè¯é€»è¾‘
   - æµ‹è¯•é…ç½®è¿ç§»æ•ˆæœ

### é˜¶æ®µ2ï¼šæ ¸å¿ƒä¼˜åŒ–ï¼ˆ2-3å¤©ï¼‰
1. æ€§èƒ½ä¼˜åŒ–
   - å®ç°TFJSåŠ¨æ€åŠ è½½
   - å®Œæˆä»£ç åˆ†å‰²å’Œç¼“å­˜é…ç½®
   - é›†æˆç›‘æ§ç³»ç»Ÿ

2. å®‰å…¨é…ç½®
   - é…ç½®CSPå’Œå…¶ä»–å®‰å…¨å¤´éƒ¨
   - å®ç°å†…å®¹å‡€åŒ–æœºåˆ¶
   - æµ‹è¯•å®‰å…¨ç­–ç•¥æ•ˆæœ

### é˜¶æ®µ3ï¼šéƒ¨ç½²éªŒè¯ï¼ˆ1å¤©ï¼‰
1. éƒ¨ç½²æµ‹è¯•
   - éƒ¨ç½²åˆ°Vercelé¢„è§ˆç¯å¢ƒ
   - æ‰§è¡Œå®Œæ•´çš„éªŒè¯Checklist
   - æ€§èƒ½å’Œå…¼å®¹æ€§æµ‹è¯•

2. ç”Ÿäº§éƒ¨ç½²
   - éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
   - ç›‘æ§å…³é”®æŒ‡æ ‡
   - å‡†å¤‡å›æ»šæ–¹æ¡ˆ

---

## 13. å¸¸ç”¨å‘½ä»¤

```bash
# æœ¬åœ°å¼€å‘
pnpm --filter app dev

# ç”Ÿäº§æ„å»º
pnpm --filter app build

# åŒ…ä½“åˆ†æ
ANALYZE=true pnpm --filter app build

# ç±»å‹æ£€æŸ¥
pnpm --filter app type-check

# ä»£ç æ ¼å¼åŒ–
pnpm format

# ä»£ç æ£€æŸ¥
pnpm lint
```

---

## 14. ç›‘æ§æŒ‡æ ‡

### å…³é”®æŒ‡æ ‡
- **æ€§èƒ½æŒ‡æ ‡**ï¼šLighthouseåˆ†æ•° > 90ï¼Œé¦–åŒ…åŠ è½½ < 3ç§’
- **é”™è¯¯ç‡**ï¼šå‰ç«¯é”™è¯¯ç‡ < 0.1%ï¼ŒAPIé”™è¯¯ç‡ < 1%
- **ç”¨æˆ·ä½“éªŒ**ï¼šé¡µé¢åœç•™æ—¶é—´ > 2åˆ†é’Ÿï¼Œè·³å‡ºç‡ < 30%
- **ç§»åŠ¨ç«¯**ï¼šiOS/Androidå…¼å®¹æ€§ > 95%

### å‘Šè­¦é˜ˆå€¼
- é¡µé¢åŠ è½½æ—¶é—´ > 5ç§’
- é”™è¯¯ç‡ > 1%
- å†…å­˜ä½¿ç”¨ > 100MB
- FPS < 30

---

**æ¨èå®æ–½é¡ºåº**ï¼šP0é˜»å¡é¡¹ â†’ P1é‡è¦é¡¹ â†’ P2ä¼˜åŒ–é¡¹ â†’ P3é•¿æœŸé¡¹

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š1-2å‘¨ï¼ˆå–å†³äºå›¢é˜Ÿè§„æ¨¡ï¼‰

**å›æ»šå‡†å¤‡**ï¼šæ¯ä¸ªé˜¶æ®µå®Œæˆååˆ›å»ºgit tagï¼Œç¡®ä¿å¯å¿«é€Ÿå›æ»š