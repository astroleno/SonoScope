# 整体提升报告 TODO（可执行版）

## 高优先级（本周内）
- [ ] 拆分 `app/app/page.tsx` 为 4 个子组件（控制、可视化、状态、设置）
- [ ] 建立统一 `logger`（区分 dev/prod 等级；生产构建移除 console）
- [ ] 增加最小安全头与 CSP（`report-only`，Next Header 配置）
- [ ] 扩展现有 Worker：将节拍/HPSS/embedding 推理放入 Worker，定义消息协议/超时/回退
- [ ] 在 Vitest 开启覆盖率并设定阈值（语句/分支/函数 ≥ 80%）

## 中优先级（两周内）
- [ ] 新增 1 个最小 E2E 场景（Playwright：启动→授权→渲染→弹幕事件）
- [ ] 增加渲染节流/采样（渲染 60Hz、特征 10–20Hz、统计 1–2Hz）
- [ ] 统一清理机制（RAF/interval/事件/Ref）避免泄漏
- [ ] 依赖升级（分步、保持与 Next 14 的兼容；评估 Next 15 升级路径）
- [ ] 接入 Sentry 与 Vercel Analytics（错误+性能）

## 低优先级（本月内）
- [ ] 按模块完善文档（开发、运维、故障处理、FAQ）
- [ ] 资源优化（图片/字体/缓存策略）
- [ ] 组件文档与示例（可选：Storybook）

## 验收标准
- [ ] 单测/集成覆盖率 ≥ 80%，生成覆盖率报告
- [ ] E2E 用例通过（本地与 CI）
- [ ] 主线程掉帧率下降，渲染稳定（通过性能采样记录对比）
- [ ] 安全头与 CSP 生效且无关键功能回归
- [ ] 主要页面无多余 console 输出（dev 受控、prod 去除）

## 备注
- 以上任务不改变外部 API；若涉及破坏性变更，须先评审并版本化
- 所有优化均需附带前后对比数据（基线→优化后）


