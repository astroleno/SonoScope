# 整体提升报告 TODO（可执行版）

## 高优先级（本周内｜直观体验提升）
- [ ] 启动与首次渲染优化：降低首屏特效成本（阴影/模糊/粒子数），延后非关键模型加载
- [ ] 麦克风授权与设备选择 UX：明确权限提示、自动回退到默认设备、失败重试与状态条
- [ ] 视觉预设微调：为不同风格提供更亮眼的默认配色/对比度，一键切换
- [ ] 弹幕观感优化：节拍对齐、密度控制、去重去抖、字号与颜色随强弱动态变化
- [ ] 移动端性能模式：限制到 30/45 FPS，禁用高成本特效，确保交互流畅

## 中优先级（两周内｜稳定体验）
- [ ] 扩展现有 Worker 覆盖更重的分析（节拍/HPSS/embedding），加超时/重试/主线程降级回退
- [ ] 渲染节流/采样参数可配置（渲染 60Hz、特征 10–20Hz、统计 1–2Hz，可按设备自适应）
- [ ] 统一清理机制（RAF/interval/事件/Ref）避免泄漏
- [ ] 新增 1 个最小 E2E 场景（Playwright：启动→授权→渲染→弹幕事件）
- [ ] 接入 Sentry 与 Vercel Analytics（错误+性能）

## 低优先级（本月内｜基础建设）
- [ ] 拆分 `app/app/page.tsx` 为 4 个子组件（控制、可视化、状态、设置）
- [ ] 建立统一 `logger`（区分 dev/prod 等级；生产构建移除 console）
- [ ] 增加最小安全头与 CSP（`report-only`，Next Header 配置）
- [ ] 在 Vitest 开启覆盖率并设定阈值（语句/分支/函数 ≥ 80%）
- [ ] 依赖升级（分步、保持与 Next 14 的兼容；评估 Next 15 升级路径）
- [ ] 按模块完善文档（开发、运维、故障处理、FAQ）
- [ ] 资源优化（图片/字体/缓存策略）
- [ ] 组件文档与示例（可选：Storybook）

## 验收标准
- [ ] 单测/集成覆盖率 ≥ 80%，生成覆盖率报告
- [ ] E2E 用例通过（本地与 CI）
- [ ] 主线程掉帧率下降，渲染稳定（通过性能采样记录对比）
- [ ] 安全头与 CSP 生效且无关键功能回归
- [ ] 主要页面无多余 console 输出（dev 受控、prod 去除）

## 备注
- 以上任务不改变外部 API；若涉及破坏性变更，须先评审并版本化
- 所有优化均需附带前后对比数据（基线→优化后）


